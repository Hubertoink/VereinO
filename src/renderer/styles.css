:root {
    --radius: 12px;
}

:root[data-theme="dark"] {
    --bg: #0F1115;
    --surface: #151821;
    --muted: #1C2028;
    --border: #2B3240;
    --text: #E7EAF0;
    --text-dim: #AAB3C2;
    --accent: #6AA6FF;
    --accent-hover: #8BB9FF;
    --success: #4CC38A;
    --warning: #F5C451;
    --danger: #F06A6A;
    /* Badge and semantic intensities */
    --badge-text: #E7EAF0;
    --badge-in: #4CC38A;
    --badge-out: #F06A6A;
    --success-strong: #2e7d32;
    --danger-strong: #c62828;
    --transfer-strong: #b8860b;
    /* Domain-specific swatches */
    --sphere-ideell: #6AA6FF;
    --sphere-zweck: #F5C451;
    --sphere-vermoegen: #AAB3C2;
    --sphere-wgb: #8BB9FF;
    --pm-bar: #A2E5A0;
    --pm-bank: #A0D6FF;
    --shadow-1: 0 4px 16px rgba(0, 0, 0, 0.25);
    --blur: saturate(180%) blur(10px);
    /* Tables */
    --table-row-alt: color-mix(in oklab, var(--muted) 35%, transparent);
    --table-row-sep: color-mix(in oklab, var(--border) 120%, transparent);
}

:root[data-theme="light"] {
    --bg: #F6F7F9;
    --surface: #FFFFFF;
    --muted: #EEF1F4;
    --border: #DDE2EA;
    --text: #1B2430;
    --text-dim: #5D697A;
    --accent: #6AA6FF;
    --accent-hover: #8BB9FF;
    --success: #4CC38A;
    --warning: #F5C451;
    --danger: #F06A6A;
    /* Badge and semantic intensities */
    --badge-text: #0B0E14;
    --badge-in: #4CC38A;
    --badge-out: #F06A6A;
    --success-strong: #2e7d32;
    --danger-strong: #c62828;
    --transfer-strong: #b8860b;
    /* Domain-specific swatches */
    --sphere-ideell: #6AA6FF;
    --sphere-zweck: #F5C451;
    --sphere-vermoegen: #AAB3C2;
    --sphere-wgb: #8BB9FF;
    --pm-bar: #A2E5A0;
    --pm-bank: #A0D6FF;
    --shadow-1: 0 4px 16px rgba(0, 0, 0, 0.15);
    --blur: saturate(180%) blur(10px);
    /* Tables */
    --table-row-alt: color-mix(in oklab, var(--muted) 40%, transparent);
    --table-row-sep: color-mix(in oklab, var(--border) 130%, transparent);
}

/* Color theme palettes (override accent colors). Applied via data-color-theme on <html>. */
:root[data-color-theme="default"] {
    --accent: #6AA6FF;
    --accent-hover: #8BB9FF;
}

/* Fiery Ocean */
:root[data-color-theme="fiery-ocean"] {
    /* Palette: barn red, fire brick, papaya whip, prussian blue, air superiority blue */
    --bg: #0e0f14; /* deepened backdrop */
    --surface: #141720;
    --muted: #1c2030;
    --border: #2a3142;
    --text: #EAEAF0;
    --text-dim: #A9B0BF;
    --accent: #669BBC; /* air-superiority-blue */
    --accent-hover: #8DB2CA;
    --success: #4CC38A;
    --warning: #F5C451;
    --danger: #C1121F; /* fire brick */
    --badge-in: #4CC38A;
    --badge-out: #C1121F;
    --sphere-ideell: #669BBC;
    --sphere-zweck: #F5C451;
    --sphere-vermoegen: #AAB3C2;
    --sphere-wgb: #003049; /* prussian blue */
    --pm-bar: #A2E5A0;
    --pm-bank: #669BBC;
}

/* Peachy Delight */
:root[data-color-theme="peachy-delight"] {
    --bg: #18191C;
    --surface: #1F2126;
    --muted: #262933;
    --border: #343A46;
    --text: #F2EEF1;
    --text-dim: #C9C1C6;
    --accent: #F4ACB7; /* cherry-blossom-pink */
    --accent-hover: #FFE5D9; /* champagne-pink */
    --success: #79c59a;
    --warning: #f1c27b;
    --danger: #9D8189; /* mountbatten-pink for harmony */
    --badge-in: #79c59a;
    --badge-out: #9D8189;
    --sphere-ideell: #F4ACB7;
    --sphere-zweck: #FFE5D9;
    --sphere-vermoegen: #C9C1C6;
    --sphere-wgb: #9D8189;
    --pm-bar: #bfe6c6;
    --pm-bank: #ffd3df;
}

/* Pastel Dreamland Adventure */
:root[data-color-theme="pastel-dreamland"] {
    --bg: #0E1116;
    --surface: #151922;
    --muted: #1B2030;
    --border: #2A3142;
    --text: #E8ECF2;
    --text-dim: #B6C0CF;
    --accent: #A2D2FF; /* light-sky-blue */
    --accent-hover: #BDE0FE; /* uranian-blue */
    --success: #6fd3a3;
    --warning: #f0cd7b;
    --danger: #ffafcc; /* carnation pink */
    --badge-in: #6fd3a3;
    --badge-out: #ffafcc;
    --sphere-ideell: #cdb4db; /* thistle */
    --sphere-zweck: #ffc8dd; /* fairy tale */
    --sphere-vermoegen: #bde0fe; /* uranian */
    --sphere-wgb: #a2d2ff; /* light sky blue */
    --pm-bar: #b9f3d2;
    --pm-bank: #c5e3ff;
}

/* Ocean Breeze */
:root[data-color-theme="ocean-breeze"] {
    --bg: #090B16;
    --surface: #0E1120;
    --muted: #131833;
    --border: #1C2445;
    --text: #E6F2FF;
    --text-dim: #B6D0EA;
    --accent: #00B4D8; /* pacific-cyan */
    --accent-hover: #90E0EF; /* non-photo-blue */
    --success: #55d1a0;
    --warning: #e9c15f;
    --danger: #FF6B6B;
    --badge-in: #55d1a0;
    --badge-out: #FF6B6B;
    --sphere-ideell: #0077B6; /* honolulu-blue */
    --sphere-zweck: #00B4D8; /* pacific-cyan */
    --sphere-vermoegen: #90E0EF; /* non-photo-blue */
    --sphere-wgb: #CAF0F8; /* light-cyan */
    --pm-bar: #90E0EF;
    --pm-bank: #00B4D8;
}

/* Earthy Tones */
:root[data-color-theme="earthy-tones"] {
    /* Palette inspiration: cherry-blossom-pink, champagne-pink, timberwolf, ash-gray, outer-space */
    --bg: #0F1211; /* deep charcoal with a hint of green */
    --surface: #151A18;
    --muted: #1C2421;
    --border: #2B3531;
    --text: #EDEAE5; /* warm off-white */
    --text-dim: #CFCBC3; /* muted timberwolf */
    --accent: #EDAFB8; /* cherry-blossom-pink */
    --accent-hover: #F7E1D7; /* champagne-pink */
    --success: #7FB685; /* sage */
    --warning: #D2B48C; /* tan */
    --danger: #B56576; /* muted rose */
    --badge-in: #7FB685;
    --badge-out: #B56576;
    --sphere-ideell: #EDAFB8; /* accent */
    --sphere-zweck: #D2B48C; /* tan */
    --sphere-vermoegen: #DEDBD2; /* timberwolf */
    --sphere-wgb: #4A5759; /* outer-space */
    --pm-bar: #B0C4B1; /* ash-gray */
    --pm-bank: #EDAFB8; /* accent */
}

html,
body,
#root {
    height: 100%;
    min-width: 1264px; /* safety net: matches BrowserWindow minWidth incl. left sidebar */
}

body {
    margin: 0;
    background: var(--bg);
    color: var(--text);
    font-family: Inter, "Plus Jakarta Sans", Segoe UI, system-ui, -apple-system, sans-serif;
    line-height: 1.4;
}

h1 {
    font-size: 24px;
    margin: 0 0 8px;
}

h2 {
    font-size: 18px;
    margin: 24px 0 8px;
}

code,
pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
}

.container {
    padding: 16px 24px;
}

/* Scrollbar styling: darker track and subtle thumb to match theme */
:root {
    /* Firefox */
    scrollbar-width: thin;
    scrollbar-color: color-mix(in oklab, var(--text) 25%, transparent) color-mix(in oklab, var(--surface) 92%, transparent);
}

/* Chromium/WebKit */
*::-webkit-scrollbar {
    width: 10px;
    height: 10px;
}
*::-webkit-scrollbar-track {
    background: color-mix(in oklab, var(--surface) 92%, transparent);
    border-radius: 10px;
}
*::-webkit-scrollbar-thumb {
    background: color-mix(in oklab, var(--text) 25%, transparent);
    border-radius: 10px;
    border: 2px solid transparent; /* creates some spacing from edges */
    background-clip: padding-box;
}
*::-webkit-scrollbar-thumb:hover {
    background: color-mix(in oklab, var(--text) 35%, transparent);
}
*::-webkit-scrollbar-thumb:active {
    background: color-mix(in oklab, var(--accent) 40%, var(--text) 20%);
}
*::-webkit-scrollbar-corner {
    background: color-mix(in oklab, var(--surface) 92%, transparent);
}

.btn {
    border: 0;
    border-radius: 10px;
    padding: 8px 12px; /* default buttons with label */
    font-weight: 600;
    background: var(--muted);
    color: var(--text);
    cursor: pointer;
}

/* Icon-only buttons: remove padding so focus/hover outline centers on icon square */
.btn.icon,
.btn.ghost[style*="place-items: center"],
.btn.danger[style*="place-items: center"] {
    padding: 0;
}

.btn.primary {
    background: var(--accent);
    color: #0B0E14;
}

.btn.primary:hover {
    background: var(--accent-hover);
}

.btn.ghost {
    background: transparent;
}

.btn.danger {
    background: color-mix(in oklab, var(--danger) 45%, transparent);
    color: #fff;
}

.btn.danger:hover {
    background: color-mix(in oklab, var(--danger) 60%, transparent);
}

.card {
    background: color-mix(in oklab, var(--surface) 85%, transparent);
    backdrop-filter: var(--blur);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    box-shadow: var(--shadow-1);
    padding: 16px;
}

.badge {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 999px;
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 0.3px;
}

.badge.in {
    background: color-mix(in oklab, var(--badge-in) 25%, transparent);
    color: var(--badge-text);
}

.badge.out {
    background: color-mix(in oklab, var(--badge-out) 25%, transparent);
    color: var(--badge-text);
}

.badge.transfer {
    background: color-mix(in oklab, var(--accent) 25%, transparent);
    color: var(--badge-text);
}

.badge.sphere-ideell {
    background: color-mix(in oklab, var(--sphere-ideell) 20%, transparent);
    color: var(--badge-text);
}

.badge.sphere-zweck {
    background: color-mix(in oklab, var(--sphere-zweck) 25%, transparent);
    color: var(--badge-text);
}

.badge.sphere-vermoegen {
    background: color-mix(in oklab, var(--sphere-vermoegen) 25%, transparent);
    color: var(--badge-text);
}

.badge.sphere-wgb {
    background: color-mix(in oklab, var(--sphere-wgb) 25%, transparent);
    color: var(--badge-text);
}

.badge.pm-bar {
    background: color-mix(in oklab, var(--pm-bar) 28%, transparent);
    color: #0f2a14;
}

.badge.pm-bank {
    background: color-mix(in oklab, var(--pm-bank) 28%, transparent);
    color: #0B0E14;
}

table {
    width: 100%;
    border-collapse: collapse;
}

th,
td {
    border-bottom: 1px solid var(--border);
}


.journal-table th,
.journal-table td {
    border-bottom: 1px solid var(--table-row-sep);
}

.journal-table tbody tr:nth-child(even) {
    background: var(--table-row-alt);
}

tbody tr:hover {
    background: color-mix(in oklab, var(--muted) 20%, transparent);
}

/* Brutto colorization in journal table */
td.gross-in {
    color: var(--success-strong);
    /* vibrant green */
    font-weight: 600;
}

td.gross-out {
    color: var(--danger-strong);
    /* vibrant red */
    font-weight: 600;
}

td.gross-transfer {
    color: var(--transfer-strong);
    /* dark goldenrod for visibility on both themes */
    font-weight: 700;
}

/* Sort indicator icons for table headers/buttons */
.sort-icon {
    display: inline-block;
    font-size: 0.9em;
    opacity: 0.9;
    margin-left: 4px;
}
.sort-icon.inactive {
    opacity: 0.6;
}

/* Transfer amount input highlight */
.input-transfer {
    background: color-mix(in oklab, var(--warning) 20%, var(--surface));
    border-color: color-mix(in oklab, var(--warning) 40%, var(--border));
}

/* Ensure SVG chart labels use app text color */
svg text {
    fill: var(--text);
}

.modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.4);
    display: flex;
    align-items: flex-start;
    justify-content: center;
    padding-top: 10vh;
    /* Ensure overlay sits above header (z-index: 1000), FAB (3000), and most overlays */
    z-index: 5000; /* below toasts (9999) */
}

.modal {
    width: min(720px, 96vw);
    background: color-mix(in oklab, var(--surface) 80%, transparent);
    backdrop-filter: var(--blur);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    box-shadow: var(--shadow-1);
    padding: 16px;
    max-height: 80vh;
    overflow: auto;
}

/* Wider layout for Quick-Add (Buchung) modal */
.booking-modal {
    width: min(1100px, 96vw);
    max-height: 90vh;
}

/* Two-column layout for Basis + Finanzen blocks */
.booking-modal .block-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
}

@media (max-width: 1040px) {
    .booking-modal .block-grid {
        grid-template-columns: 1fr;
    }
}

/* Responsive tweaks similar to invoice modal */
@media (max-width: 1040px) {
    .booking-modal {
        width: min(96vw, 100%);
        padding: 12px;
    }
}
@media (max-width: 880px) {
    .booking-modal {
        width: min(96vw, 100%);
        padding: 12px;
    }
}

.row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
}

/* In the wider booking modal, allow denser grids */
.booking-modal .row {
    grid-template-columns: repeat(3, 1fr);
}

@media (max-width: 1040px) {
    .booking-modal .row {
        grid-template-columns: 1fr 1fr; /* fall back to 2 cols on narrower screens */
    }
}
@media (max-width: 720px) {
    .booking-modal .row {
        grid-template-columns: 1fr; /* single column on small screens */
    }
}

.field {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.input,
select,
textarea {
    background: var(--surface);
    color: var(--text);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 8px 10px;
    font-family: inherit;
}

/* Ensure date inputs use same UI font */
input[type="date"] {
    font-family: inherit;
}

/* Input adornments (prefix/suffix like â‚¬) */
.adorn-wrap {
    position: relative;
    display: inline-flex;
    align-items: center;
}

.adorn-wrap .input {
    padding-right: 28px;
    /* space for suffix */
}

.adorn-suffix {
    position: absolute;
    right: 8px;
    color: var(--text-dim);
    font-weight: 600;
    pointer-events: none;
}

.helper {
    color: var(--text-dim);
    font-size: 12px;
}

/* Chips for active filters */
.chip {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 8px;
    border-radius: 999px;
    background: var(--muted);
    border: 1px solid var(--border);
    font-size: 12px;
}

.chip .chip-x,
.chip-x {
    border: 0;
    background: transparent;
    color: var(--text-dim);
    cursor: pointer;
}

/* Brief flash highlight for newly created/updated rows */
@keyframes rowFlash {
    0% { background-color: color-mix(in oklab, var(--accent) 45%, transparent); }
    100% { background-color: transparent; }
}

tbody tr.row-flash {
    animation: rowFlash 2.4s ease-out 1;
}

/* Toast notifications */
.toast-container {
    position: fixed;
    right: 16px;
    bottom: 16px;
    display: grid;
    gap: 8px;
    z-index: 9999;
}

.toast {
    background: color-mix(in oklab, var(--surface) 92%, transparent);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 10px 12px;
    box-shadow: var(--shadow-1);
    color: var(--text);
    min-width: 260px;
    max-width: 560px;
    display: flex;
    align-items: flex-start;
    gap: 8px;
    flex-wrap: wrap; /* allow long text and action to wrap to the next line */
}

.toast.success {
    border-left: 4px solid var(--success);
}

.toast.error {
    border-left: 4px solid var(--danger);
}

.toast .title {
    font-weight: 700;
    margin-right: 6px;
}

/* Ensure action buttons in toasts are visible when text is long */
.toast .btn {
    flex: 0 0 auto;
}

/* Chart legends outside SVG */
.legend {
    display: inline-flex;
    align-items: center;
    gap: 12px;
    color: var(--text-dim);
    font-size: 12px;
}

.legend-item {
    display: inline-flex;
    align-items: center;
    gap: 6px;
}

.legend-swatch {
    width: 10px;
    height: 10px;
    border-radius: 2px;
    border: 1px solid var(--border);
    display: inline-block;
}

/* Inputs hover/focus for better affordance */
.input:hover,
select:hover,
textarea:hover {
    border-color: color-mix(in oklab, var(--accent) 35%, var(--border));
}

.input:focus,
select:focus,
textarea:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px color-mix(in oklab, var(--accent) 25%, transparent);
}

/* Import mapping: grouped layout */
.group-grid {
    display: grid;
    /* Larger min size to avoid horizontal overlap of dropdowns */
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 12px;
}

.field-group {
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 10px;
    background: color-mix(in oklab, var(--surface) 88%, transparent);
}

.field-group>.group-title {
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: 700;
    margin-bottom: 8px;
}

.field-group .field {
    margin-top: 8px;
}

/* Field rows in mapping: label + control with responsive wrapping */
.field-row {
    display: grid;
    grid-template-columns: 1fr minmax(140px, 1fr);
    align-items: center;
    gap: 8px;
}

.field-row>.field-label {
    min-width: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.field-row select,
.field-row .input {
    width: 100%;
    min-width: 0;
}

.fg-meta {
    border-left: 4px solid color-mix(in oklab, var(--accent) 70%, transparent);
}

.fg-amounts {
    border-left: 4px solid color-mix(in oklab, var(--success) 60%, transparent);
}

.fg-payment {
    border-left: 4px solid color-mix(in oklab, #A0D6FF 60%, transparent);
}

.fg-accounts {
    border-left: 4px solid color-mix(in oklab, #F5C451 60%, transparent);
}

.fg-defaults {
    border-left: 4px solid color-mix(in oklab, #AAB3C2 60%, transparent);
}

.muted-sep {
    height: 1px;
    background: var(--border);
    margin: 8px 0;
}

.badge-default {
    display: inline-block;
    padding: 2px 6px;
    border-radius: 999px;
    font-size: 11px;
    background: color-mix(in oklab, var(--accent) 18%, transparent);
    color: #0B0E14;
    border: 1px solid color-mix(in oklab, var(--accent) 30%, var(--border));
}

.mapping-summary {
    display: grid;
    gap: 6px;
    border: 1px dashed var(--border);
    border-radius: 10px;
    padding: 10px;
}

.mapping-summary .pair {
    display: flex;
    gap: 8px;
    justify-content: space-between;
}

.mapping-summary .k {
    color: var(--text-dim);
}

.mapping-summary .v {
    max-width: 60%;
    text-overflow: ellipsis;
    overflow: hidden;
    white-space: nowrap;
}

/* Inline label + control pairing to avoid line breaks between them */
.inline-field {
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

/* Floating Action Button (FAB) for + Buchung */
.fab {
    position: fixed;
    right: 24px;
    bottom: 24px;
    z-index: 3000;
    /* above cards and tables, below toasts (9999) */
    border: none;
    border-radius: 14px;
    font-weight: 800;
    padding: 14px 20px;
    font-size: 16px;
    box-shadow: 0 10px 24px rgba(0, 0, 0, 0.35);
    opacity: 0.90;
    cursor: pointer;
}

.fab-buchung {
    background: var(--accent);
    color: #0B0E14;
}

.fab-buchung:hover {
    background: var(--accent-hover);
    color: #0B0E14;
}

/* Responsive tweaks for the invoice modal at minimal widths */
@media (max-width: 1040px) {
    .invoice-modal {
        width: min(96vw, 100%);
        padding: 12px;
    }
    .invoice-modal .party-input {
        max-width: 260px; /* narrower Partei at minimal app width */
    }
    .invoice-modal .amount-input {
        max-width: 220px; /* narrower Betrag at minimal app width */
    }
    .invoice-modal .tags-editor .input {
        max-width: 520px; /* cap tags row to avoid stretching */
    }
}
@media (max-width: 880px) {
    .invoice-modal {
        width: min(96vw, 100%);
        padding: 12px;
    }
    .invoice-modal .party-input {
        max-width: 320px;
    }
    .invoice-modal .amount-input {
        max-width: 260px;
    }
    .invoice-modal .tags-editor .input {
        /* tighten the inline container to avoid overflow */
        padding: 6px 8px;
    }
}

@media (max-width: 720px) {
    .invoice-modal .party-input {
        max-width: 260px;
    }
    .invoice-modal .amount-input {
        max-width: 220px;
    }
}